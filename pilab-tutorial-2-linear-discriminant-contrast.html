<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>Pilab tutorial 2: linear discriminant contrast - Johan Carlin</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



<link rel="canonical" href="http://www.johancarlin.com/pilab-tutorial-2-linear-discriminant-contrast.html">

        <meta name="author" content="Johan Carlin" />
        <meta name="keywords" content="scientific computing,matlab,pilab" />
        <meta name="description" content="This post is the second of a series of tutorials where I illustrate basic fMRI analyses with pilab. Today we will construct a pseudo-distance matrix with cross-validated linear discriminant contrast. In addition to pilab you will need my figure code and probably my general-purpose utility code to get the example below to run. Have fun!" />

        <meta property="og:site_name" content="Johan Carlin" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="Pilab tutorial 2: linear discriminant contrast"/>
        <meta property="og:url" content="http://www.johancarlin.com/pilab-tutorial-2-linear-discriminant-contrast.html"/>
        <meta property="og:description" content="This post is the second of a series of tutorials where I illustrate basic fMRI analyses with pilab. Today we will construct a pseudo-distance matrix with cross-validated linear discriminant contrast. In addition to pilab you will need my figure code and probably my general-purpose utility code to get the example below to run. Have fun!"/>
        <meta property="article:published_time" content="2016-05-29" />
            <meta property="article:section" content="code" />
            <meta property="article:tag" content="scientific computing" />
            <meta property="article:tag" content="matlab" />
            <meta property="article:tag" content="pilab" />
            <meta property="article:author" content="Johan Carlin" />


    <!-- Bootstrap -->
        <link rel="stylesheet" href="http://www.johancarlin.com/theme/css/bootstrap.lumen.min.css" type="text/css"/>
    <link href="http://www.johancarlin.com/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="http://www.johancarlin.com/theme/css/pygments/borland.css" rel="stylesheet">
        <link href="http://www.johancarlin.com/theme/css/typogrify.css" rel="stylesheet">
    <link rel="stylesheet" href="http://www.johancarlin.com/theme/css/style.css" type="text/css"/>

        <link href="http://www.johancarlin.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="Johan Carlin ATOM Feed"/>



        <link href="http://www.johancarlin.com/feeds/code.atom.xml" type="application/atom+xml" rel="alternate"
              title="Johan Carlin code ATOM Feed"/>

</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
	<div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="http://www.johancarlin.com/" class="navbar-brand">
Johan Carlin            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                         <li><a href="http://www.johancarlin.com/pages/about-me.html">
                             About&nbsp;Me
                          </a></li>
                        <li class="active">
                            <a href="http://www.johancarlin.com/category/code.html">Code</a>
                        </li>
                        <li >
                            <a href="http://www.johancarlin.com/category/science.html">Science</a>
                        </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->
<!-- Banner -->
<!-- End Banner -->
<div class="container">
    <div class="row">
        <div class="col-sm-9">
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="http://www.johancarlin.com/pilab-tutorial-2-linear-discriminant-contrast.html"
                       rel="bookmark"
                       title="Permalink to Pilab tutorial 2: linear discriminant contrast">
                        Pilab tutorial 2: linear discriminant&nbsp;contrast
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2016-05-29T00:00:00+01:00"> 29 May 2016</time>
    </span>





<span class="label label-default">Tags</span>
	<a href="http://www.johancarlin.com/tag/scientific-computing.html">scientific computing</a>
        /
	<a href="http://www.johancarlin.com/tag/matlab.html">matlab</a>
        /
	<a href="http://www.johancarlin.com/tag/pilab.html">pilab</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <style type="text/css">/*!
*
* IPython notebook
*
*/
/* <span class="caps">CSS</span> font colors for translated <span class="caps">ANSI</span> colors. */
.ansibold {
  font-weight: bold;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  border-left-width: 1px;
  padding-left: 5px;
  background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%);
}
div.cell.jupyter-soft-selected {
  border-left-color: #<span class="caps">90CAF9</span>;
  border-left-color: #<span class="caps">E3F2FD</span>;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #<span class="caps">E3F2FD</span>;
  border-right-width: 1px;
  background: #<span class="caps">E3F2FD</span>;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected {
  border-color: #ababab;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #<span class="caps">42A5F5</span> -40px, #<span class="caps">42A5F5</span> 5px, transparent 5px, transparent 100%);
}
@media print {
  div.cell.selected {
    border-color: transparent;
  }
}
div.cell.selected.jupyter-soft-selected {
  border-left-width: 0;
  padding-left: 6px;
  background: linear-gradient(to right, #<span class="caps">42A5F5</span> -40px, #<span class="caps">42A5F5</span> 7px, #<span class="caps">E3F2FD</span> 7px, #<span class="caps">E3F2FD</span> 100%);
}
.edit_mode div.cell.selected {
  border-color: #<span class="caps">66BB6A</span>;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #<span class="caps">66BB6A</span> -40px, #<span class="caps">66BB6A</span> 5px, transparent 5px, transparent 100%);
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
@-moz-document url-prefix() {
  div.inner_cell {
    overflow-x: hidden;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell > div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #<span class="caps">303F9F</span>;
  border-top: 1px solid transparent;
}
div.input_area > div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area > div.highlight > pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the <head> if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In <span class="caps">CM2</span>, this used to be 0.4em, but in <span class="caps">CM3</span> it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  padding: 0.4em;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In <span class="caps">CM3</span> this went to 4px from 0 in <span class="caps">CM2</span>. We need the 0 value because of how we size */
  /* .CodeMirror-lines */
  padding: 0;
  border: 0;
  border-radius: 0;
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org>
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #<span class="caps">BA2121</span>;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #<span class="caps">AA22FF</span>;
  font-weight: bold;
}
.highlight-meta {
  color: #<span class="caps">AA22FF</span>;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #<span class="caps">AA22FF</span>;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #<span class="caps">BA2121</span>;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #<span class="caps">AA22FF</span>;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but <span class="caps">FF</span> barfs all over that */
  height: 24em;
  /* <span class="caps">FF</span> needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/<span class="caps">FF</span> */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area 
div.output_area 
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}



.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}






.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}








.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}


.rendered_html pre,



.rendered_html tr,
.rendered_html th,

.rendered_html td,


.rendered_html * + table {
  margin-top: 1em;
}

.rendered_html * + p {
  margin-top: 1em;
}

.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,

.rendered_html img.unconfined,

div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell > div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered 
.text_cell.unrendered .text_cell_render {
  display: none;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
</style>
<style type="text/css">.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #<span class="caps">FF0000</span> } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #<span class="caps">BC7A00</span> } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #<span class="caps">FF0000</span> } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #<span class="caps">0044DD</span> } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #<span class="caps">BA2121</span> } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #<span class="caps">0000FF</span>; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #<span class="caps">AA22FF</span> } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #<span class="caps">D2413A</span>; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #<span class="caps">0000FF</span> } /* Name.Function */
.highlight .nl { color: #<span class="caps">A0A000</span> } /* Name.Label */
.highlight .nn { color: #<span class="caps">0000FF</span>; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #<span class="caps">AA22FF</span>; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sb { color: #<span class="caps">BA2121</span> } /* Literal.String.Backtick */
.highlight .sc { color: #<span class="caps">BA2121</span> } /* Literal.String.Char */
.highlight .sd { color: #<span class="caps">BA2121</span>; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #<span class="caps">BA2121</span> } /* Literal.String.Double */
.highlight .se { color: #<span class="caps">BB6622</span>; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #<span class="caps">BA2121</span> } /* Literal.String.Heredoc */
.highlight .si { color: #<span class="caps">BB6688</span>; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #<span class="caps">BB6688</span> } /* Literal.String.Regex */
.highlight .s1 { color: #<span class="caps">BA2121</span> } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style>
<style type="text/css">
/* Temporary definitions which will become obsolete with Notebook release 5.0 */
.ansi-black-fg { color: #<span class="caps">3E424D</span>; }
.ansi-black-bg { background-color: #<span class="caps">3E424D</span>; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #<span class="caps">E75C58</span>; }
.ansi-red-bg { background-color: #<span class="caps">E75C58</span>; }
.ansi-red-intense-fg { color: #<span class="caps">B22B31</span>; }
.ansi-red-intense-bg { background-color: #<span class="caps">B22B31</span>; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #<span class="caps">DDB62B</span>; }
.ansi-yellow-bg { background-color: #<span class="caps">DDB62B</span>; }
.ansi-yellow-intense-fg { color: #<span class="caps">B27D12</span>; }
.ansi-yellow-intense-bg { background-color: #<span class="caps">B27D12</span>; }
.ansi-blue-fg { color: #<span class="caps">208FFB</span>; }
.ansi-blue-bg { background-color: #<span class="caps">208FFB</span>; }
.ansi-blue-intense-fg { color: #<span class="caps">0065CA</span>; }
.ansi-blue-intense-bg { background-color: #<span class="caps">0065CA</span>; }
.ansi-magenta-fg { color: #<span class="caps">D160C4</span>; }
.ansi-magenta-bg { background-color: #<span class="caps">D160C4</span>; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #<span class="caps">60C6C8</span>; }
.ansi-cyan-bg { background-color: #<span class="caps">60C6C8</span>; }
.ansi-cyan-intense-fg { color: #<span class="caps">258F8F</span>; }
.ansi-cyan-intense-bg { background-color: #<span class="caps">258F8F</span>; }
.ansi-white-fg { color: #<span class="caps">C5C1B4</span>; }
.ansi-white-bg { background-color: #<span class="caps">C5C1B4</span>; }
.ansi-white-intense-fg { color: #<span class="caps">A1A6B2</span>; }
.ansi-white-intense-bg { background-color: #<span class="caps">A1A6B2</span>; }

.ansi-bold { font-weight: bold; }
</style>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This post is the second of a series of tutorials where I illustrate basic fMRI analyses with <a href="https://github.com/jooh/pilab">pilab</a>. Today we will construct a pseudo-distance matrix with cross-validated linear discriminant contrast. In addition to pilab you will need my <a href="https://github.com/jooh/matlab-plotting">figure code</a> and probably my <a href="https://github.com/jooh/johansmatlab">general-purpose utility code</a> to get the example below to run. Have&nbsp;fun!</p>
<h3 id="Building-simulated-fMRI-data">Building simulated fMRI data<a class="anchor-link" href="#Building-simulated-fMRI-data">&#182;</a></h3><p>To review, we are going to make up some data to model. If you read <a href="pilab-tutorial-1-model-fit-and-cross-validation.html">part 1</a> in this series you can skip ahead to the next&nbsp;section.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="c">% shuffle the random number generator</span>
<span class="n">rng</span><span class="p">(</span><span class="s">&#39;shuffle&#39;</span><span class="p">);</span>
<span class="c">% control variables for the simulation</span>
<span class="c">% number of volumes (TRs)</span>
<span class="n">n</span> <span class="p">=</span> <span class="mi">200</span><span class="p">;</span>
<span class="c">% frame period - one volume every tr s</span>
<span class="n">tr</span> <span class="p">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="c">% number of onsets to include in each run</span>
<span class="n">ntrial</span> <span class="p">=</span> <span class="mi">20</span><span class="p">;</span>
<span class="n">ncon</span> <span class="p">=</span> <span class="mi">4</span><span class="p">;</span>
<span class="n">nvox</span> <span class="p">=</span> <span class="mi">50</span><span class="p">;</span>
<span class="n">nrun</span> <span class="p">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="c">% true parameters - same across runs. +1 to model variations in constant</span>
<span class="n">b</span> <span class="p">=</span> <span class="nb">rand</span><span class="p">(</span><span class="n">ncon</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">nvox</span><span class="p">);</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For each run of the experiment, we make up a set of <em>onsets</em> (uniformly distributed over the run), and assign
each onset to a <em>conind</em> (effectively the column index in the final design matrix). We then convolve the onsets
with a hemodynamic response function to construct the run-specific design matrix <em>X</em>.</p>
<p>The signal in this run is simply the design matrix weighted by the true parameters, <em>X</em>*<em>b</em>. To this we add a touch of noise to construct the final&nbsp;data.</p>
<p>Finally, we plug the convolved design matrix and data into Volume instances. These are container classes that make is easy to index in the sample dimension (e.g. runs) or feature dimension (e.g., regions of interest) while keeping any meta data in&nbsp;register.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">designvol</span> <span class="p">=</span> <span class="n">cell</span><span class="p">(</span><span class="n">nrun</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="n">datavol</span> <span class="p">=</span> <span class="n">cell</span><span class="p">(</span><span class="n">nrun</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="k">for</span> <span class="n">r</span> <span class="p">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">nrun</span>
    <span class="c">% different trial order in each run</span>
    <span class="n">conind</span> <span class="p">=</span> <span class="nb">ceil</span><span class="p">(</span><span class="nb">rand</span><span class="p">(</span><span class="n">ntrial</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">ncon</span><span class="p">);</span>
    <span class="n">onsets</span> <span class="p">=</span> <span class="nb">rand</span><span class="p">(</span><span class="n">ntrial</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">n</span><span class="p">;</span>
    <span class="n">X</span> <span class="p">=</span> <span class="p">[</span><span class="n">convolveonsets</span><span class="p">(</span><span class="n">onsets</span><span class="p">,</span><span class="n">conind</span><span class="p">,</span><span class="n">tr</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="s">&#39;dur&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="nb">ones</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mi">1</span><span class="p">)];</span>
    <span class="c">% scale design matrix to peak at 1</span>
    <span class="n">X</span> <span class="p">=</span> <span class="n">X</span> <span class="o">/</span> <span class="n">max</span><span class="p">(</span><span class="n">X</span><span class="p">(:));</span>
    <span class="c">% construct data as some mixture of gaussian noise and the true parameters</span>
    <span class="c">% scaled by each predictor</span>
    <span class="n">data</span> <span class="p">=</span> <span class="nb">randn</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">nvox</span><span class="p">)</span><span class="o">*</span><span class="p">.</span><span class="mi">3</span> <span class="o">+</span> <span class="n">X</span><span class="o">*</span><span class="n">b</span><span class="p">;</span>
    <span class="c">% build Volume instances for convolved design and data</span>
    <span class="n">metasamp</span> <span class="p">=</span> <span class="n">struct</span><span class="p">(</span><span class="s">&#39;chunks&#39;</span><span class="p">,</span><span class="nb">ones</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">r</span><span class="p">);</span>
    <span class="n">designvol</span><span class="p">{</span><span class="n">r</span><span class="p">}</span> <span class="p">=</span> <span class="n">Volume</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="s">&#39;frameperiod&#39;</span><span class="p">,</span><span class="n">tr</span><span class="p">,</span><span class="s">&#39;metasamples&#39;</span><span class="p">,</span><span class="n">metasamp</span><span class="p">,</span><span class="c">...</span>
        <span class="s">&#39;metafeatures&#39;</span><span class="p">,</span><span class="n">struct</span><span class="p">(</span><span class="s">&#39;labels&#39;</span><span class="p">,{{</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">,</span><span class="s">&#39;c&#39;</span><span class="p">,</span><span class="s">&#39;d&#39;</span><span class="p">,</span><span class="s">&#39;constant&#39;</span><span class="p">}}));</span>
    <span class="n">datavol</span><span class="p">{</span><span class="n">r</span><span class="p">}</span> <span class="p">=</span> <span class="n">Volume</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="s">&#39;frameperiod&#39;</span><span class="p">,</span><span class="n">tr</span><span class="p">,</span><span class="s">&#39;metasamples&#39;</span><span class="p">,</span><span class="n">metasamp</span><span class="p">);</span>
<span class="k">end</span>
<span class="c">% operator overloading means we can use standard concatenation syntax to combine</span>
<span class="c">% the Volume instances over runs</span>
<span class="n">datavol</span> <span class="p">=</span> <span class="nb">cat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">datavol</span><span class="p">{:});</span>
<span class="n">designvol</span> <span class="p">=</span> <span class="nb">cat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">designvol</span><span class="p">{:});</span>

<span class="p">[</span><span class="n">filtereddatavol</span><span class="p">,</span><span class="n">filtereddesignvol</span><span class="p">]</span> <span class="p">=</span> <span class="n">preprocessvols</span><span class="p">(</span><span class="n">datavol</span><span class="p">,</span><span class="n">designvol</span><span class="p">,</span><span class="c">...</span>
    <span class="s">&#39;covariatedeg&#39;</span><span class="p">,</span><span class="s">&#39;&#39;</span><span class="p">,</span><span class="s">&#39;ignorelabels&#39;</span><span class="p">,</span><span class="s">&#39;constant&#39;</span><span class="p">);</span>
<span class="n">model</span> <span class="p">=</span> <span class="n">vol2glm</span><span class="p">(</span><span class="n">filtereddesignvol</span><span class="p">,</span><span class="n">filtereddatavol</span><span class="p">);</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>(preprocessvols) projecting out 1 covariates
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Estimating-representational-distance-with-cross-validated-linear-discriminant-contrasts">Estimating representational distance with cross-validated linear discriminant contrasts<a class="anchor-link" href="#Estimating-representational-distance-with-cross-validated-linear-discriminant-contrasts">&#182;</a></h3><p>Representational similarity analysis (<span class="caps">RSA</span>) is a somewhat jargony name for a simple statistical concept: analysing your data at the level of distance matrices rather than at the level of individual response channels (voxels in our case). The beauty of this is that we need not specify an exact mapping of model features to response amplitudes of individual voxels. Beyond this theoretical convenience, there is also often a practical advantage in sensitivity over conventional activation-based brain mapping approaches (although to be precise, the advantage is not exactly in raw sensitivity but rather in testing a less strict hypothesis. You must decide for yourself if your research question is suitable to hypotheses at the distance matrix&nbsp;level).</p>
<p>It is not always appreciated that the choice of distance metric has a huge effect on what your <span class="caps">RSA</span> results look like (for a more formal discussion of distance metric effects, see <a href="https://dx.doi.org/10.1016/j.neuroimage.2015.12.012">Walther et al., in press, NeuroImage</a>). We generally prefer to use a cross-validated linear discriminant contrast (<span class="caps">LDC</span>) metric. The neat thing about <span class="caps">LDC</span> compared to metrics that aren&#8217;t cross-validated is that the distance estimate is centered on zero under the null hypothesis of no difference between the conditions. In this sense, <span class="caps">LDC</span> has a strong relationship with conventional <span class="caps">LDA</span> classification. This makes it possible to generalise <span class="caps">RSA</span> to  &#8216;decoding&#8217;-like analyses by testing whether different parts of our distance matrices (or averages of parts of the distance matrix) are reliably greater than zero, or differ reliably amongst&nbsp;themselves.</p>
<p>More popular distance metrics such as Pearson correlation distance tend to produce <em>large</em> distance estimates when response estimates are noisy (intuitively, noise does not correlate, so the correlation distance ends up being 1-0), which can produce misleading impressions of how a given region distinguishes your conditions (ie, stimuli that cannot be distinguished in a classification sense because their estimates are noisy are assigned a large distance). Cross-validated metrics have a closer link to conventional classification and are therefore closer to our intuitive understanding of what it means for conditions to evoke dissimilar&nbsp;responses.</p>
<p>It is however worth remembering that cross-validated metrics aren&#8217;t strictly speaking distances, since they can take negative values. This can complicate things with real&nbsp;data.</p>
<p>In any case, let&#8217;s unpack how linear discriminant contrast is calculated. First off, let&#8217;s do it the quick, easy pilab&nbsp;route:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="c">% cross-validated linear discriminant contrast (train on 1, test on 2)</span>
<span class="n">m</span> <span class="p">=</span> <span class="n">infoc</span><span class="p">(</span><span class="n">model</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">discriminant</span><span class="p">(</span><span class="n">model</span><span class="p">(</span><span class="mi">1</span><span class="p">),[</span><span class="mi">1</span> <span class="o">-</span><span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">]),[</span><span class="mi">1</span> <span class="o">-</span><span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>m =
    2.5290
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>What&#8217;s going on here? Linear discriminant contrasts are usually introduced in a cursory or maths-heavy manner in the literature, and consequently they are not often understood (or used, outside a few labs). This is unfortunate because although there are many operations below, none of them are actually that hard to understand if you are familiar with linear regression. Let&#8217;s go through the calculations at a lower&nbsp;level:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="c">% OLS fit of data from run 1</span>
<span class="n">est1</span> <span class="p">=</span> <span class="n">model</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">X</span> <span class="o">\</span> <span class="n">model</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">data</span><span class="p">;</span>
<span class="c">% contrast between the conditions of interest</span>
<span class="n">con1</span> <span class="p">=</span> <span class="p">[</span><span class="mi">1</span> <span class="o">-</span><span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">est1</span><span class="p">;</span>
<span class="c">% fitted time course</span>
<span class="n">predict1</span> <span class="p">=</span> <span class="n">model</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">X</span> <span class="o">*</span> <span class="n">est1</span><span class="p">;</span>
<span class="c">% residual time courses</span>
<span class="n">res1</span> <span class="p">=</span> <span class="n">model</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">data</span> <span class="o">-</span> <span class="n">predict1</span><span class="p">;</span>
<span class="c">% (sparse) covariance of the residuals - see Misaki et al., 2010, NeuroImage. You could use the</span>
<span class="c">% built-in cov function with very similar results.</span>
<span class="n">cov1</span> <span class="p">=</span> <span class="n">covdiag</span><span class="p">(</span><span class="n">res1</span><span class="p">);</span>
<span class="c">% now the linear discriminant weights vector is just the contrast multiplied by the inverse of the</span>
<span class="c">% covariance estimator - note that so far, nothing we have done differs from bog-standard LDA.</span>
<span class="n">w1</span> <span class="p">=</span> <span class="n">con1</span> <span class="o">/</span> <span class="n">cov1</span><span class="p">;</span>
<span class="c">% additionally we scale the weights to unit length, which turns out to be useful for expressing</span>
<span class="c">% the cross-validated discriminant in the units of the test data.</span>
<span class="n">w1</span> <span class="p">=</span> <span class="n">unitlen</span><span class="p">(</span><span class="n">w1</span><span class="p">);</span>
<span class="c">% now we get to the part where the discriminant contrast differs from conventional classification,</span>
<span class="c">% where you would attempt to predict the label for individual observations in the test data. Instead,</span>
<span class="c">% our discriminant contrast metric can be thought of as the distance of the (average) test data from</span>
<span class="c">% the hyperplane defined by w1.</span>
<span class="c">% OLS fit of data from run 2</span>
<span class="n">est2</span> <span class="p">=</span> <span class="n">model</span><span class="p">(</span><span class="mi">2</span><span class="p">).</span><span class="n">X</span> <span class="o">\</span> <span class="n">model</span><span class="p">(</span><span class="mi">2</span><span class="p">).</span><span class="n">data</span><span class="p">;</span>
<span class="c">% contrast between conditions of interest in run 2</span>
<span class="n">con2</span> <span class="p">=</span> <span class="p">[</span><span class="mi">1</span> <span class="o">-</span><span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">est2</span><span class="p">;</span>
<span class="c">% and now the linear discriminant contrast is just the dot product between the weights vector</span>
<span class="c">% and the contrast estimate from the test data. Intuitively, consistent signed values will sum</span>
<span class="c">% and inconsistent signs will subtract from the final statistic.</span>
<span class="n">m</span> <span class="p">=</span> <span class="n">con2</span> <span class="o">*</span> <span class="n">w1</span><span class="o">&#39;</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>m =
    2.5290
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>I hope you&#8217;ll agree that the pilab code is easier to work with (and less prone to typos and other user errors) than coding this up yourself&#8230; Note that linear discriminant contrasts can also be thought of as a cross-validated version of the Mahalanobis distance, although I&#8217;ll spare you the details (see <a href="https://dx.doi.org/10.1371/journal.pcbi.1003553">Nili et al., 2014, PloS <span class="caps">CB</span></a>). To be precise, the equivalence doesn&#8217;t quite hold for the pilab implementation above since we use a sparse covariance&nbsp;estimator.</p>
<h3 id="Rapidly-estimate-full-distance-matrices-over-multiple-regions-of-interest">Rapidly estimate full distance matrices over multiple regions of interest<a class="anchor-link" href="#Rapidly-estimate-full-distance-matrices-over-multiple-regions-of-interest">&#182;</a></h3><p>So if we are happy with how <span class="caps">LDC</span> works, let&#8217;s see how we can quickly run a full analysis. Let&#8217;s estimate a full distance matrix over all 4 conditions, with each contrast estimate being the mean over the 2 possible train-test splits of the runs, and with separate summaries for 3 regions of interest. For this we turn to a high-level analysis function, which takes care of all the heavy lifting involved in converting a set of data and design Volumes to a result. This code runs in a highly optimised parallel computing mode if your Matlab install supports it, which can be useful when calculating very large numbers of <span class="caps">ROI</span> results (e.g. in searchlight&nbsp;mapping).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="c">% let&#39;s first build an additional region of interest Volume, which stores the valid</span>
<span class="c">% features for each ROI</span>
<span class="n">roivol</span> <span class="p">=</span> <span class="n">Volume</span><span class="p">([</span><span class="nb">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">nvox</span><span class="p">);</span> <span class="nb">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">floor</span><span class="p">(</span><span class="n">nvox</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span> <span class="nb">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">ceil</span><span class="p">(</span><span class="n">nvox</span><span class="o">/</span><span class="mi">2</span><span class="p">));</span> <span class="c">...</span>
    <span class="nb">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">floor</span><span class="p">(</span><span class="n">nvox</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span> <span class="nb">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">ceil</span><span class="p">(</span><span class="n">nvox</span><span class="o">/</span><span class="mi">2</span><span class="p">))],</span><span class="s">&#39;metasamples&#39;</span><span class="p">,</span><span class="n">struct</span><span class="p">(</span><span class="c">...</span>
    <span class="s">&#39;names&#39;</span><span class="p">,{{</span><span class="s">&#39;allfeatures&#39;</span><span class="p">,</span><span class="s">&#39;firsthalf&#39;</span><span class="p">,</span><span class="s">&#39;secondhalf&#39;</span><span class="p">}}));</span>
<span class="c">% now we can just call this high-level analysis function to obtain the</span>
<span class="c">% cross-validated linear discriminant contrast for each pair of conditions, and for</span>
<span class="c">% each region</span>
<span class="n">disvol</span> <span class="p">=</span> <span class="n">roidata2rdmvol_lindisc_batch</span><span class="p">(</span><span class="n">roivol</span><span class="p">,</span><span class="n">filtereddesignvol</span><span class="p">,</span><span class="n">filtereddatavol</span><span class="p">);</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>(rdms_lindisc_configureprocess) testmeth: infoc
(GLMProcessor.GLMProcessor) detected *SELF* placeholder
(roidata2rdmvol_lindisc_batch) running ROIProcessing with runrois_serial
(roidata2rdmvol_lindisc_batch) running all rois... (roidata2rdmvol_lindisc_batch) finished in 0 days, 00:00:00.065
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You guessed it, the result is another Volume instance&#8230; Finally, let&#8217;s visualise the distance matrix we just&nbsp;estimated.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="c">%plot -s 700,700 -r 300 -f svg</span>
<span class="n">fh</span> <span class="p">=</span> <span class="n">gcf</span><span class="p">;</span>
<span class="c">% round to 1 decimal place</span>
<span class="n">maxd</span> <span class="p">=</span> <span class="n">reduceprecision</span><span class="p">(</span><span class="n">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">disvol</span><span class="p">.</span><span class="n">data</span><span class="p">(:))),</span><span class="mi">1</span><span class="p">);</span>
<span class="p">[</span><span class="n">fh</span><span class="p">,</span><span class="n">ax</span><span class="p">,</span><span class="n">intmap</span><span class="p">,</span><span class="n">cmap</span><span class="p">]</span> <span class="p">=</span> <span class="n">rdmfig</span><span class="p">(</span><span class="n">disvol</span><span class="p">.</span><span class="n">data</span><span class="p">,</span><span class="n">disvol</span><span class="p">.</span><span class="n">meta</span><span class="p">.</span><span class="n">features</span><span class="p">.</span><span class="n">names</span><span class="p">,[],</span><span class="n">fh</span><span class="p">,</span><span class="c">...</span>
    <span class="s">&#39;limits&#39;</span><span class="p">,[</span><span class="o">-</span><span class="n">maxd</span> <span class="n">maxd</span><span class="p">]);</span>
<span class="n">cbax</span> <span class="p">=</span> <span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span>
<span class="n">c</span> <span class="p">=</span> <span class="n">colorbarbetter</span><span class="p">(</span><span class="n">cbax</span><span class="p">,</span><span class="n">intmap</span><span class="p">{</span><span class="k">end</span><span class="p">},</span><span class="n">cmap</span><span class="p">{</span><span class="k">end</span><span class="p">},</span><span class="s">&#39;label&#39;</span><span class="p">,</span><span class="s">&#39;linear discriminant contrast&#39;</span><span class="p">,</span><span class="s">&#39;scale&#39;</span><span class="p">,.</span><span class="mi">5</span><span class="p">);</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>


<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAArwAAAK8CAIAAACC2PsUAAAACXBIWXMAABcSAAAXEgFnn9JSAAAA
B3RJTUUH4AUeDgErHY/79QAAACR0RVh0U29mdHdhcmUATUFUTEFCLCBUaGUgTWF0aFdvcmtzLCBJ
bmMuPFjdGAAAACJ0RVh0Q3JlYXRpb24gVGltZQAzMC1NYXktMjAxNiAxNTowMTo0M/zpoAQAABUO
SURBVHic7d29jiv3fcdhDsndNVwY6ezScJFOEFxYRQrDUBXLd6ALcBFfgAFfQIDcQBLoAtyljOIm
QpDChV0ZqtwESWvAhk9h6xy+7KSgvaKGM8Pv8GX/w+HzQBBWe2aHPw4PZz4czlJVXdczAIBj5qUH
AABug2gAACKiAQCIiAYAICIaAICIaAAAIqIBAIiIBgAgIhoAgIhoAAAiogEAiIgGACAiGgCAiGgA
ACKiAQCIiAYAICIaAICIaAAAIqIBAIiIBgAgIhoAgIhoAAAiy9IDANCnqqrdF3Vdv/zn7usLrv/M
FTZW0piZyRAN92v/Se4JD+P08mS87Aqv+tS++MyMh2ig6XpP+FfYW8Ek7T9rbuUZdCtzMohooJ0n
PAANogFgpF5O+3W9mfjyddc7jDuH3+867df/1uT+arteVxy9CW6aaJi45EneunzrE37QLqOxzNHd
X2PJ/n1iMkzXfhMmpvFX/fAdxqqqjv79P1xJz9M/XCfTIxqm7IJP8tbd0Ky3Ks68xf7VHh3mtP0m
jEprLnctufui64m5+/vfv8LGSvafModnIF7WefLM3CLRMFn5k3xfuE+ZdR+5u27xzF1J676pa5j+
/eYJtw5jlidFuMzLs/WE9TBtPtxp4i74Qr+xqv23Dy5+iz3rHDRMYxm7PO5E9VeXWqGnDzvONEzW
xZ/hR3dAr7lPSfaGPm2CO9QI6As+C3z6AjPRMG2v/yQfyW7levtNuAmHJ+cue0lT1/sXTJ5omKZr
PMn79zivvFsZ+h7t+ftNuAmH799d6pnoucNMNEzbtZ/krbunq95iOMz19ptwE1p/8eGy67/4OrkJ
LoS8F+c8yVsvMzz6qxD5Le4vGV45Ef66xAnDwE1r/O5S13tzJ1wmWe3Z/+Z583JjnGmYstbn82Xf
2jzhFvcP8C8nAE7Y9fT8SNdqnV/lHhyeVzvzrFvjR656DoOR8xbvZPU8yXs+jHbWewqhdZ35Le4v
0/opCxccZqYYAC5NNAAAEdc0AAAR0QAAREQDABARDQBARDQAABHRAABERAMAEBENAEBENAAAEdEA
AEREAwAQEQ0AQEQ0AAAR0QAAREQDABBZlh6As/z04TulRxjmzea59AgDvPeNp9IjDPOTN78tPQJf
+uz9D0qPMMCffvfn0iMM863vfrP0CMN879P/LD3CBTjTAABERAMAEBENAEBENAAAEdEAAEREAwAQ
EQ0AQEQ0AAAR0QAAREQDABARDQBARDQAABHRAABERAMAEBENAEBENAAAEdEAAEREAwAQEQ0AQEQ0
AAAR0QAAREQDABARDQBARDQAABHRAABERAMAEBENAEBENAAAEdEAAEREAwAQEQ0AQEQ0AAAR0QAA
REQDABARDQBARDQAABHRAABERAMAEBENAEBENAAAEdEAAEREAwAQEQ0AQEQ0AAAR0QAAREQDABAR
DQBARDQAABHRAABERAMAEBENAEBENAAAEdEAAEREAwAQEQ0AQEQ0AAAR0QAARJalBxidnz58p/QI
A/zT+n9KjzDML3/w/dIjDPDFH96WHoEvffb+B6VHGObD3/yq9AgDfP7xR6VHGGbzxab0CPfImQYA
ICIaAICIaAAAIqIBAIiIBgAgIhoAgIhoAAAiogEAiIgGACAiGgCAiGgAACKiAQCIiAYAICIaAICI
aAAAIqIBAIiIBgAgIhoAgIhoAAAiogEAiIgGACAiGgCAiGgAACKiAQCIiAYAICIaAICIaAAAIqIB
AIiIBgAgIhoAgIhoAAAiogEAiIgGACAiGgCAiGgAACKiAQCIiAYAICIaAICIaAAAIqIBAIiIBgAg
IhoAgIhoAAAiogEAiIgGACAiGgCAiGgAACKiAQCIiAYAICIaAICIaAAAIqIBAIiIBgAgIhoAgIho
AAAiogEAiIgGACAiGgCAyLL0AKPzZvNceoQBfvmD75ceYZi/+6//Lj3CAJ9++/3SI/ClP/3uz6VH
GObzjz8qPcIA7/3809IjDPPrH35YeoR75EwDABARDQBARDQAABHRAABERAMAEBENAEBENAAAEdEA
AEREAwAQEQ0AQEQ0AAAR0QAAREQDABARDQBARDQAABHRAABERAMAEBENAEBENAAAEdEAAEREAwAQ
EQ0AQEQ0AAAR0QAAREQDABARDQBARDQAABHRAABERAMAEBENAEBENAAAEdEAAEREAwAQEQ0AQEQ0
AAAR0QAAREQDABARDQBARDQAABHRAABERAMAEBENAEBENAAAEdEAAEREAwAQEQ0AQEQ0AAAR0QAA
REQDABARDQBARDQAABHRAABERAMAEBENAEBENAAAEdEAAEREAwAQWZYeYHTe+8ZT6REG+OIPb0uP
MMyn336/9AgDfPS/vyk9AsCIiAbgNnzru98sPcIwmy82pUcY4Nc//LD0CMN87z8+Kz3CPfL2BAAQ
EQ0AQEQ0AAAR0QAAREQDABARDQBARDQAABHRAABERAMAEBENAEBENAAAEdEAAEREAwAQEQ0AQEQ0
AAAR0QAAREQDABARDQBARDQAABHRAABERAMAEBENAEBENAAAEdEAAEREAwAQEQ0AQEQ0AAAR0QAA
REQDABARDQBARDQAABHRAABERAMAEBENAEBENAAAEdEAAEREAwAQEQ0AQEQ0AAAR0QAAREQDABAR
DQBARDQAABHRAABERAMAEBENAEBENAAAEdEAAEREAwAQEQ0AQEQ0AAAR0QAAREQDABARDQBARDQA
ABHRAABERAMAEFmWHmB0fvLmt6VHAIAxquq6Lj0DAHADvD0BAEREAwAQEQ0AQEQ0AAAR0QAAREQD
ABARDQBARDQAABHRAABERAMAEBENAEBENAAAEdEAAEREAwAQEQ0AQEQ0AAAR0QAAREQDABARDQBA
RDQAABHRAABERAMAEBENAEBENAAAEdEAAEREAwAQEQ0AQEQ0AAAR0QAAREQDABARDQBARDQAABHR
AABERAMAEBENAEBENAAAEdEAAEREAwAQEQ0AQEQ0AAAR0QAAREQDABARDQBARDQAABHRAABERAMA
EBENAEBENAAAEdEAAEREAwAQEQ0AQEQ0AAAR0QAAREQDABARDQBARDQAABHRAABERAMAEBENAEBE
NAAAEdEAAEREAwAQEQ0AQEQ0AAAR0QAARJalB4CvqKpqNpvVdd34+iIrfPnP81cLcIecaeCOvBQD
ACdwpoG74xwDwGmcaQAAIs40TFPjPHzra+v9ZbpefPcv0/Onh5cmnDPGRVbyssxFLpUAuEOVXef0
tL5zv/9Ad721f3SZw8sJ+xeo67onX3quMGjURs+crYsd3kr/JAAknGmYmtaX0VVVVVUzEAdlxG6B
xkqOrmF/+dY1nD/G4RmI1js72+sGuQBwGtc03IW6rg/PATQWmPWewG997d6zhsOf6nn/omuZoys5
+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
">
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="What-about-linear-discriminant-T-statistics?">What about linear discriminant T statistics?<a class="anchor-link" href="#What-about-linear-discriminant-T-statistics?">&#182;</a></h3><p>The first papers to use something like <span class="caps">LDC</span> tended to report a related but distinct metric - a linear discriminant T statistic or <span class="caps">LDT</span> (<a href="http://dx.doi.org/10.1073/pnas.0705654104">Kriegeskorte et al. 2007, <span class="caps">PNAS</span></a>). In a way it&#8217;s unfortunate that this method appeared first because it is more complex to calculate and understand than <span class="caps">LDC</span>. Let&#8217;s return to the example to understand how it differs. To start with, here is the high level pilab implementation for&nbsp;reference:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="c">% to get from infoc to infot, just call a different GLM class method</span>
<span class="n">t</span> <span class="p">=</span> <span class="n">infot</span><span class="p">(</span><span class="n">model</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">discriminant</span><span class="p">(</span><span class="n">model</span><span class="p">(</span><span class="mi">1</span><span class="p">),[</span><span class="mi">1</span> <span class="o">-</span><span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">]),[</span><span class="mi">1</span> <span class="o">-</span><span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>t =
   21.0993
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The first thing to note is that the calculation of the weights vector remains similar to standard <span class="caps">LDA</span>, just like with <span class="caps">LDC</span>. However, whereas in <span class="caps">LDC</span> the test statistic is estimated by projecting the contrast estimate onto the discriminant dimension (ie, the weights vector), for <span class="caps">LDT</span> this won&#8217;t do the job since we need an estimate of the <em>variance</em> of the discriminant to calculate T. Instead, we&#8217;re going to project the full time courses onto the discriminant, like&nbsp;so:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="c">% we go from one feature per voxel to one feature per discriminant</span>
<span class="n">disctime</span> <span class="p">=</span> <span class="n">model</span><span class="p">(</span><span class="mi">2</span><span class="p">).</span><span class="n">data</span> <span class="o">*</span> <span class="n">w1</span><span class="o">&#39;</span><span class="p">;</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It took me a long time to work out the consequences of doing this. Let&#8217;s visualise what the discriminant time courses look like to help guide our&nbsp;intuition.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="c">%plot -s 700,700 -r 300 -f svg</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="n">plot</span><span class="p">(</span><span class="n">disctime</span><span class="p">);</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;data&#39;</span><span class="p">);</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
<span class="n">plot</span><span class="p">(</span><span class="n">model</span><span class="p">(</span><span class="mi">2</span><span class="p">).</span><span class="n">X</span><span class="p">(:,</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">));</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;regressors of interest&#39;</span><span class="p">);</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span>
<span class="n">plot</span><span class="p">(</span><span class="n">model</span><span class="p">(</span><span class="mi">2</span><span class="p">).</span><span class="n">X</span><span class="p">(:,</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">[</span><span class="mi">1</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">&#39;</span><span class="p">);</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;contrast time course&#39;</span><span class="p">);</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>


<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
">
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Notice how the discriminant goes up whenever a stimulus belonging to condition 1 appears, and down whenever a stimulus belonging to condition 2 appears. Indeed, the discriminant time course looks a lot like the time course you get if you contrast the two predicted time&nbsp;courses.</p>
<p>So now that we have a discriminant time course we can just fit it to the design matrix and estimate the same contrast that went into the calculation of the weights vector. And once we have that, standard errors and T statistics can be calculated like any multiple regression model. Neat. I won&#8217;t belabour the point by coding out the full T statistic code, but basically we just build a new <span class="caps">GLM</span> instance and estimate contrasts and t statistics just like with any other&nbsp;model.</p>
<p>By the way, what do you think that discriminant time course contrast estimate looks&nbsp;like?</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="c">% parameter estimates for the test design matrix fitted to the discriminant time course</span>
<span class="n">discest</span> <span class="p">=</span> <span class="n">model</span><span class="p">(</span><span class="mi">2</span><span class="p">).</span><span class="n">X</span> <span class="o">\</span> <span class="n">disctime</span><span class="p">;</span>
<span class="c">% contrast estimate</span>
<span class="n">disccon</span> <span class="p">=</span> <span class="p">[</span><span class="mi">1</span> <span class="o">-</span><span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">discest</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>disccon =
    2.5290
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>That&#8217;s right, it&#8217;s the <span class="caps">LDC</span> again. The dot-product-of-the-contrast approach above is an equivalent (and more computationally efficient) way to arrive at the same result. But by going about it in this roundabout way we have shown that <span class="caps">LDC</span> and <span class="caps">LDT</span> really differ only in whether you scale by the standard error estimate or&nbsp;not.</p>
<h3 id="Why-is-LDC-preferable-to-LDT?">Why is <span class="caps">LDC</span> preferable to <span class="caps">LDT</span>?<a class="anchor-link" href="#Why-is-LDC-preferable-to-LDT?">&#182;</a></h3><p>The appealing thing about <span class="caps">LDT</span> is that because it is expressed in standard error units, it provides a somewhat intuitive idea about effect size (well, technically we might prefer <em><span class="caps">LDZ</span></em> instead to avoid the dependence on degrees of freedom, but to my knowledge no one has reported using this). But this interpretability advantage breaks down when you consider cross-validation. If you run standard N-fold validation over say 5 runs, you will end up with 5 separate LDTs that you will average. That average is no longer a T statistic, and in fact you now run the risk of confusing your readers by reporting tiny, tiny &#8216;T&#8217; statistics that are nevertheless highly significant. In my view, <span class="caps">LDT</span> is best suited to cases where you only plan to test your model on a single validation set,&nbsp;once.</p>
<p>That&#8217;s it for today. Stay tuned for future posts, where we will cover how pilab implements non-parametric statistical inference and random effects group analysis for <span class="caps">RSA</span> and standard univariate&nbsp;models.</p>
<h4 id="Updates">Updates<a class="anchor-link" href="#Updates">&#182;</a></h4><ul>
<li>30 May 2016: reran simulation after fixing indexing error in&nbsp;preprocessvols</li>
</ul>

</div>
</div>
</div>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>

            </div>
            <!-- /.entry-content -->
    <hr/>
    <section class="comments" id="comments">
        <h2>Comments</h2>

        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'johancarlin'; // required: replace example with your forum shortname

                    var disqus_identifier = 'pilab-tutorial-2-linear-discriminant-contrast';
                var disqus_url = 'http://www.johancarlin.com/pilab-tutorial-2-linear-discriminant-contrast.html';

            var disqus_config = function () {
                this.language = "en";
            };

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
            Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </section>
        </article>
    </section>

        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>

<section class="well well-sm">
    <ul class="list-group list-group-flush">
            <li class="list-group-item"><h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Social</span></h4>
              <ul class="list-group" id="social">
                <li class="list-group-item"><a href="https://github.com/jooh"><i class="fa fa-code-square fa-lg"></i> code</a></li>
                <li class="list-group-item"><a href="https://twitter.com/johancarlin"><i class="fa fa-rants-square fa-lg"></i> rants</a></li>
                <li class="list-group-item"><a href="https://anaconda.org/jcarlin"><i class="fa fa-python-packages-square fa-lg"></i> python packages</a></li>
                <li class="list-group-item"><a href="https://www.mendeley.com/profiles/johan-carlin"><i class="fa fa-publications-square fa-lg"></i> publications</a></li>
                <li class="list-group-item"><a href="https://getpocket.com/@idoru"><i class="fa fa-long-reads-square fa-lg"></i> long reads</a></li>
              </ul>
            </li>





    <li class="list-group-item"><h4><i class="fa fa-external-link-square fa-lg"></i><span class="icon-label">Links</span></h4>
      <ul class="list-group" id="links">
        <li class="list-group-item">
            <a href="http://www.ucl.ac.uk/lovelab" target="_blank">
                Love lab
            </a>
        </li>
        <li class="list-group-item">
            <a href="http://www.mrc-cbu.cam.ac.uk/our-research/kriegeskorte" target="_blank">
                Kriegeskorte lab
            </a>
        </li>
        <li class="list-group-item">
            <a href="http://gru.stanford.edu" target="_blank">
                Gardner lab
            </a>
        </li>
      </ul>
    </li>
    </ul>
</section>
            </aside>
        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2016 Johan Carlin
            &middot; Powered by <a href="https://github.com/getpelican/pelican-themes/tree/master/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="http://www.johancarlin.com/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="http://www.johancarlin.com/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="http://www.johancarlin.com/theme/js/respond.min.js"></script>

    <!-- Disqus -->
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'johancarlin'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <!-- End Disqus Code -->
    <!-- Google Analytics -->
    <script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-33066815-1']);
        _gaq.push(['_trackPageview']);

        (function () {
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();
    </script>
    <!-- End Google Analytics Code -->

</body>
</html>